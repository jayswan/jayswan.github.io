---
layout: post
title: '"Hello World" in Bro IDS'
date: '2013-01-11T20:32:00.001-07:00'
author: Jay Swan
tags: 
modified_time: '2013-01-11T20:34:32.903-07:00'
blogger_id: tag:blogger.com,1999:blog-5029689981158113588.post-2298438382366527499
blogger_orig_url: http://unroutable.blogspot.com/2013/01/hello-world-in-bro-ids.html
---

One of the reasons I don't blog that much is that I generally assume that everything worth blogging has already been done, and that everyone reading is probably smarter than me and doesn't need me to explain things. I'm going to pretend that those are non-issues and try to blog more, no matter how basic the topic.&nbsp; <br /><br />I just got back from <a href="https://www.cert.org/flocon/" target="_blank">FloCon 2013</a>, which was quite interesting. The highlight for me was some informal after-hours knowledge-dumps from Seth Hall (<a href="https://twitter.com/remor" target="_blank">@remor</a>) and Liam Randall (<a href="https://twitter.com/Hectaman" target="_blank">@hectaman</a>) on the subject of <a href="http://www.bro-ids.org/" target="_blank">Bro</a> (<a href="https://twitter.com/Bro_IDS" target="_blank">@Bro_IDS</a>).<br /><br />Before these mini-lessons, I didn't really have a good idea of how to get started with Bro scripting. Now I do!<br /><br />The stuff we covered was actually a lot more complex than Hello World, but in the spirit of beginning coders everywhere, here's how you do "Hello World" in Bro (and a little more):<br /><br /><pre>ubuntu@ip-10-73-25-224:~/bro$ cat hello.bro </pre><pre>bro_init()<br />    <span style="color: #4444ff;"><b>{</b></span><br />    print <span style="color: green;">"Hello World!"</span><span style="color: #4444ff;">;</span><br />    <span style="color: #4444ff;"><b>}</b></span><br /><br />bro_done()<br />    <span style="color: #4444ff;"><b>{</b></span><br />    print <span style="color: green;">"Goodbye World!"</span><span style="color: #4444ff;">;</span><br />    <span style="color: #4444ff;"><b>}</b></span><br /></pre><br />The fundamental idea behind Bro is that it's a scripting language that responds to events that are derived from packet streams. When Bro is monitoring a raw packet feed or ingesting a pcap file, it fires events whenever something interesting happens: FTP sessions, HTTP sessions, SSH sessions, etc.<br /><br />The script above responds to the two simplest Bro events: the startup and shutdown of the software. If we run Bro from the CLI with a dummy pcap file to ingest, it writes the output to the terminal:<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><span style="font-size: small;">ubuntu@ip-10-73-25-224:~/bro$ bro -C -r foo.pcap hello.bro<br />Hello World!<br />Goodbye World!</span></div><br />Of course, this isn't something we'd ever do in a real Bro environment; we'd want to be actually looking at the packet stream and taking actions in response to it. Stay tuned for more.