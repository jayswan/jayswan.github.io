---
layout: post
title: Understanding Flow Export Terminology
date: '2013-08-02T16:43:00.000-06:00'
author: Jay Swan
tags: 
modified_time: '2013-09-04T07:00:02.475-06:00'
blogger_id: tag:blogger.com,1999:blog-5029689981158113588.post-7240303518901739531
blogger_orig_url: http://unroutable.blogspot.com/2013/08/understanding-flow-export-terminology.html
---

The variety of terms used to describe network flow export technologies and components can be pretty confusing. Just last year I wrote a post on <a href="http://unroutable.blogspot.com/2012/04/why-netflow-isnt-web-usage-tracker.html" target="_blank">web usage tracking and NetFlow</a> that is already a bit obsolete, so here's an attempt to explain some of the newer terms and capabilities in use today. <br /><br /><b>NetFlow Version 5</b><br />NetFlow v5 is sort of the least common denominator in flow technologies. Almost all vendors and devices that support a flow export technology will do NetFlow v5. Because it's only capable of exporting information about packet fields up to layer 4, however, it's not flexible enough to use for analytics that require information about the application layer. NetFlow v5 tracks only the following data:<br /><ul><li>Source interface</li><li>Source and destination IP address</li><li>Layer 4 protocol</li><li>TCP flags</li><li>Type of Service</li><li>Egress interface</li><li>Packet count</li><li>Byte count</li><li>BGP origin AS</li><li>BGP peer AS</li><li>IP next hop</li><li>Source netmask</li><li>Destination netmask</li></ul><b>Netflow Version 9</b><br />Netflow v9 was Cisco's first attempt at defining an extensible flow export format, defined in <a href="https://www.ietf.org/rfc/rfc3954.txt" target="_blank">RFC 3954</a> back in 2004. It provides a flexible format for building customizable flow export records that contain a wide variety of information types. Many of the goals for flexible flow export were defined in <a href="https://tools.ietf.org/html/rfc3917" target="_blank">RFC 3917</a>:<br /><ul><li>&nbsp;Usage-based accounting</li><li>Traffic profiling</li><li>Traffic engineering</li><li>Attack/Intrusion Detection</li><li>QoS monitoring</li></ul>The RFC defines 79 field types that may be exported in NetFlow v9 packets, and directs the reader to the Cisco website for further field types. The <a href="http://www.cisco.com/en/US/technologies/tk648/tk362/technologies_white_paper09186a00800a3db9.html" target="_blank">latest document I could find</a> there defines 104 field types, several of which are reserved for vendor proprietary use and some of which are reserved for Cisco use.<br /><br /><b>IPFIX</b><br />IPFIX is the IETF standard for extensible flow export. The basic protocol is specified in <a href="https://www.ietf.org/rfc/rfc5101.txt" target="_blank">RFC 5101</a>, but details are included in many other RFCs (Wikipedia has a <a href="https://en.wikipedia.org/wiki/IPFIX#External_links" target="_blank">partial list</a>). IPFIX is based directly on NetFlow v9 and is generally interoperable, but since it's an open standard it is extensible without Cisco involvement. Hundreds of field types are defined in the <a href="https://www.iana.org/assignments/ipfix/ipfix.xhtml" target="_blank">IANA IPFIX documentation</a>.<br /><br /><a href="https://datatracker.ietf.org/doc/rfc6759/?include_text=1" target="_blank">RFC 6759</a> defines an extension of IPFIX to include application-specific information in IPFIX export&nbsp; packets. This allows deep-packet-inspection technologies (such as Cisco's NBAR) to send information about non-standardized, tunneled, or encrypted application layer protocols to IPFIX collectors.<br /><br />IPFIX is being used by various vendors (Plixer, Lancope, and nProbe/nTop come to mind) to export HTTP header data, making it capable of being used as a web usage tracker or web forensics tool with the appropriate collector/analyzer software. <br /><br /><b>Flexible NetFlow</b><br />As far as I can tell, Flexible NetFlow is a marketing term used by Cisco to encompass everything about their approach to configuring and implementing NetFlow v9 and IPFIX.<br /><br /><b>NSEL (NetFlow Security Event Logging)</b><br />NSEL is a proprietary extension of NetFlow v9 to used by Cisco's ASA firewalls to export firewall log data. It's not clear to me why Cisco didn't use IPFIX for this purpose.<br /><br /><b>Cisco AVC (Application Visibility and Control)</b><br />AVC is another Cisco marketing term that encompasses a variety of technologies surrounding the DPI and application-based routing capabilities in its routers, such as IPFIX, NetFlow v9, NBAR, PfR, ART (Application Response Time), and more.<br /><br /><b>Other Vendors</b><br />As mentioned above, most network technology vendors support NetFlow v5 and/or v9. IPFIX support is now becoming very common. Some vendors use proprietary extensions of NetFlow v9; Riverbed's CascadeFlow is one example of this.<br /><br />In a followup post, I'll take a look at some tools that produce flow data without using export technologies.<br /><br />