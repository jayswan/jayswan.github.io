---
layout: post
title: Cisco CDR Timestamp and IP Address Conversion
date: '2012-02-10T21:51:00.003-07:00'
author: Jay Swan
tags:
- python cucm callmanager communicationsmanager cdr timestamp ip address
modified_time: '2012-02-10T21:54:56.049-07:00'
blogger_id: tag:blogger.com,1999:blog-5029689981158113588.post-6509333606912756868
blogger_orig_url: http://unroutable.blogspot.com/2012/02/cisco-cdr-timestamp-and-ip-address.html
---

The call detail records (CDRs) used by Cisco Unified Communications Manager (aka Call Manager) can be tricky to interpret. Two fields that are frequently confusing are the IP address fields and the timestamp field.<br /><br />Continuing my theme of using Python to help with Cisco product administration, here's how to convert timestamps and IP addresses to human-readable format.<br /><br />Timestamps are pretty easy. They're recorded in UNIX epoch time and there are lots of examples available showing how to convert them using Excel or various scripting tools. In Python: <br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">import time</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">def time_to_string(time_value):</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; """convert Unix epoch time to a human readable string"""</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">&nbsp;&nbsp;&nbsp; return time.strftime("%m/%d/%Y %H:%M:%S",time.localtime(float(time_value)))</div><br />It took me a while to figure out how to convert IPv4 addresses, since CUCM uses signed 32-bit integers to represent IP addresses and Python's long integers can be of infinite length. First, a review of how to do the conversion manually is in order. Let's say that a CUCM CDR lists an IP address as "-2126438902". First, we convert this signed 32-bit integer to hex using Windows calculator:<br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">-2126438902 = 0x81411E0A</div><br />Next, we break the hex number into 1-byte chunks, and reverse the order:<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">0x0A</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">0x1E</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">0x41</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">0x81</div><br />Finally, we convert each byte to decimal and put them together into an IP address:<br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;"><br /></div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">10.30.65.129</div><br />Here's the Python function to do the conversion:<br /><br /><script src="https://gist.github.com/1796357.js">  </script><br /><br />And here it is in the interpreter showing that it works for reasonable input types:<br /><br /><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">&gt;&gt;&gt; int_to_ip('-2126438902')</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">'10.30.65.129'</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">&gt;&gt;&gt; int_to_ip(-2126438902)</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">'10.30.65.129'</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">&gt;&gt;&gt; int_to_ip(-2126438902L)</div><div style="font-family: &quot;Courier New&quot;,Courier,monospace;">'10.30.65.129'</div><br />&nbsp;I don't have access to an IPv6-aware CUCM install, so you're on your own for that!